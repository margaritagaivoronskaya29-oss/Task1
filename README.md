# ReadMe: Класс Model

Предоставлю описание класса **Model**, который отвечает за обучение, сохранение, загрузку и тестирование модели классификации гистологических изображений.
В качестве базовой архитектуры используется **предобученная GoogLeNet** из `torchvision.models`.

## Полученные баллы

**Основная часть:**

* Реализована модель классификации, основанной на сверточных нейронных сетях (GoogLeNet),
  **точность ACC ≥ 0.95** на предоставленной тестовой выборке — **30 баллов** (LBL2)

**Дополнения:**

* автоматический выбор GPU/CPU — **1 балл** (LBL1)
* предобработка входных изображений (Resize, ToTensor, Normalize) — **1 балл** (LBL3)
* Автоматичесский выбор гиперпараметров модели во время обучения - **1-3 балл(ов)** (LBL4)
* Вывод показателей обучения (loss, val_acc) — **1 балл** (LBL5)
* Автоматическое сохранение лучшей модели — **1 балл** (LBL6)


## Назначение класса Model

Класс **Model** содержит всю ключевую логику работы с моделью глубокого обучения:

* **Инициализация** GoogLeNet и настройка классификатора под нужное число классов
* **Сохранение и загрузка** весов модели (локально или из Google Drive)
* **Обучение** с валидацией и автосохранением
* **Оценка точности** на валидации
* **Тестирование** модели на отдельных изображениях и целых датасетах


## Зависимости

Класс Model использует следующие зависимости:

* **torch, torch.nn, torch.optim** — обучение нейронных сетей
* **torchvision.models, torchvision.transforms** — модель GoogLeNet и трансформация изображений
* **numpy** — работа с изображениями
* **tqdm** — прогресс-бары
* **urllib** — ссылки
* **gdown** — загрузка весов из Google Drive


## Методы класса Model


### `__init__`

**Назначение:**
Создает GoogLeNet, настраивает классификатор, загружает предобученные веса, определяет трансформации.

**Дополнительные действия:**

* Определяет устройство `cuda` или `cpu`
* Заменяет последний FC-слой под `NUM_CLASSES`
* Перемещает модель на устройство


### `save`

**Назначение:**
Сохраняет веса модели в файл `/content/drive/MyDrive/{name}.pth`.

### `load`

**Назначение:**
Загружает веса модели из Google Drive по ID.

### `train`

**Назначение:**
Обучает модель на датасете.

**Что происходит:**

1. Деление данных на train/val
2. Создание внутреннего класса `TissueTorchDS` и DataLoader’ов
3. Инициализация:

   * потерь `CrossEntropyLoss`
   * оптимизатора `Adam`
   * scheduler-а `ReduceLROnPlateau`
4. В каждой эпохе:

   * прямой проход → вычисление loss
   * backward → обновление весов
   * подсчет среднего loss
   * валидация через `evaluate`
5. Сохранение лучшей модели


### `evaluate`

**Назначение:**
Оценивает модель на валидационном DataLoader.


### `test_on_dataset`

**Назначение:**
Запускает тестмрование на всём датасете или на его части.

**Назначение:**
Классификация одного изображения.
